@page "/"
@inject ICommunicationService CommSvc
@inject NavigationManager Nav

<MudPaper Class="pa-4">
    <MudTable Items="@items" Dense="true" Hover="true">
        <HeaderContent>
            <MudTh>Title</MudTh>
            <MudTh>Type</MudTh>
            <MudTh>Status</MudTh>
            <MudTh>Updated</MudTh>
            <MudTh />
        </HeaderContent>
        <RowTemplate>
            <MudTd>@context.Title</MudTd>
            <MudTd>@context.TypeCode</MudTd>
            <MudTd>@context.CurrentStatus</MudTd>
            <MudTd>@context.LastUpdatedUtc.ToLocalTime().ToString("g")</MudTd>
            <MudTd>
                <MudButton Variant="Variant.Text" OnClick="@(() => Nav.NavigateTo($"details/{context.Id}"))">Details</MudButton>
            </MudTd>
        </RowTemplate>
    </MudTable>
</MudPaper>

@code {
    List<CommunicationDto> items = [];

    protected override async Task OnInitializedAsync()
        => items = await CommSvc.GetAllAsync();
}
